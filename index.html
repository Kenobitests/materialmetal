<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Arquimedes - Identificador de Metais</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@300;400;700&display=swap');
        body { font-family: 'JetBrains Mono', monospace; }
        .glass-panel { background: rgba(15, 23, 42, 0.8); backdrop-filter: blur(10px); }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            height: 20px;
            width: 20px;
            border-radius: 50%;
            background: #3b82f6;
            cursor: pointer;
        }
    </style>
</head>
<body class="bg-[#0f172a] text-slate-200 min-h-screen">

    <!-- Header -->
    <header class="p-6 border-b border-slate-800 flex justify-between items-center">
        <div>
            <h1 class="text-blue-500 text-[10px] font-bold tracking-tighter uppercase leading-none">
                <i class="fas fa-microchip"></i> System-Mobile v3.0
            </h1>
            <h2 class="text-xl font-light text-white italic">Arquimedes Lab</h2>
        </div>
        <div id="status-tag" class="text-[9px] bg-slate-900 border border-slate-700 px-2 py-1 rounded text-green-500 animate-pulse">
            ONLINE
        </div>
    </header>

    <main class="p-4 max-w-lg mx-auto pb-24">
        
        <!-- Input Card -->
        <section class="glass-panel border border-slate-800 p-5 rounded-2xl shadow-2xl mb-6">
            <h3 class="text-white text-xs font-bold uppercase mb-4 flex items-center gap-2">
                <i class="fas fa-flask text-blue-400"></i> Calibração de Amostra
            </h3>
            
            <div class="space-y-5">
                <div>
                    <label class="text-[10px] text-slate-500 uppercase block mb-1">Peso no Ar (g)</label>
                    <input id="wAir" type="number" step="0.01" placeholder="0.00" 
                           class="w-full bg-black border border-slate-700 p-3 text-xl text-blue-400 rounded-lg outline-none focus:border-blue-500">
                </div>

                <div>
                    <label class="text-[10px] text-slate-500 uppercase block mb-1">Peso da Água Deslocada (g)</label>
                    <input id="wWater" type="number" step="0.01" placeholder="0.00"
                           class="w-full bg-black border border-slate-700 p-3 text-xl text-cyan-400 rounded-lg outline-none focus:border-cyan-500">
                </div>

                <div class="pt-2">
                    <div class="flex justify-between text-[9px] mb-2 uppercase font-bold text-slate-500">
                        <span>Precisão</span>
                        <span id="precision-val">±0.15</span>
                    </div>
                    <input id="precision" type="range" min="0.05" max="0.5" step="0.01" value="0.15" 
                           class="w-full h-1 bg-slate-800 rounded-lg appearance-none cursor-pointer">
                </div>
            </div>
        </section>

        <!-- Result Display -->
        <div id="results-area" class="hidden space-y-6">
            <div class="bg-blue-600 p-5 rounded-2xl shadow-lg flex justify-between items-center overflow-hidden relative">
                <div class="relative z-10">
                    <p class="text-[10px] font-bold uppercase opacity-80">Densidade Relativa</p>
                    <p id="density-val" class="text-4xl font-black">0.000</p>
                    <p class="text-[10px] opacity-80">g/cm³</p>
                </div>
                <i class="fas fa-tint absolute -right-2 -bottom-2 text-6xl opacity-20"></i>
            </div>

            <!-- Chart -->
            <div class="bg-slate-900 border border-slate-800 p-4 rounded-2xl">
                <p class="text-[10px] text-slate-500 uppercase mb-4 font-bold text-center">Curva de Probabilidade</p>
                <div class="h-48">
                    <canvas id="probChart"></canvas>
                </div>
            </div>

            <!-- Ranking -->
            <div class="bg-slate-900 border border-slate-800 p-4 rounded-2xl">
                <p class="text-[10px] text-slate-500 uppercase mb-4 font-bold">Identificação Provável</p>
                <div id="ranking-list" class="space-y-3">
                    <!-- JS fills this -->
                </div>
            </div>
        </div>

        <!-- Initial Placeholder -->
        <div id="placeholder" class="py-20 text-center border-2 border-dashed border-slate-800 rounded-2xl">
            <i class="fas fa-balance-scale text-slate-700 text-3xl mb-3"></i>
            <p class="text-slate-500 text-[10px] uppercase tracking-widest">Aguardando Medições</p>
        </div>

    </main>

    <script>
        const METALS_DB = [
            { name: 'Alumínio', density: 2.70, color: '#94a3b8' },
            { name: 'Titânio', density: 4.54, color: '#64748b' },
            { name: 'Ferro', density: 7.87, color: '#b45309' },
            { name: 'Aço', density: 8.00, color: '#78350f' },
            { name: 'Latão', density: 8.50, color: '#ca8a04' },
            { name: 'Cobre', density: 8.96, color: '#ea580c' },
            { name: 'Prata', density: 10.49, color: '#cbd5e1' },
            { name: 'Chumbo', density: 11.34, color: '#1e293b' },
            { name: 'Ouro', density: 19.32, color: '#fbbf24' },
            { name: 'Platina', density: 21.45, color: '#f8fafc' }
        ];

        let myChart = null;

        function getProb(x, mean, std) {
            return (1 / (std * Math.sqrt(2 * Math.PI))) * Math.exp(-0.5 * Math.pow((x - mean) / std, 2));
        }

        function update() {
            const air = parseFloat(document.getElementById('wAir').value);
            const water = parseFloat(document.getElementById('wWater').value);
            const precision = parseFloat(document.getElementById('precision').value);
            
            document.getElementById('precision-val').innerText = `±${precision.toFixed(2)}`;

            if (!air || !water || air <= 0 || water <= 0) {
                document.getElementById('results-area').classList.add('hidden');
                document.getElementById('placeholder').classList.remove('hidden');
                return;
            }

            document.getElementById('results-area').classList.remove('hidden');
            document.getElementById('placeholder').classList.add('hidden');

            const densityExp = air / water;
            document.getElementById('density-val').innerText = densityExp.toFixed(3);

            // Calculate Matches
            const chances = METALS_DB.map(m => {
                const p = getProb(m.density, densityExp, precision);
                return { ...m, probRaw: p };
            });

            const sumProb = chances.reduce((a, b) => a + b.probRaw, 0);
            const normalized = chances.map(m => ({
                ...m,
                chance: sumProb > 0 ? (m.probRaw / sumProb) * 100 : 0
            })).sort((a, b) => b.chance - a.chance);

            // Update List
            const list = document.getElementById('ranking-list');
            list.innerHTML = '';
            normalized.filter(m => m.chance > 0.5).slice(0, 5).forEach(m => {
                const div = document.createElement('div');
                div.className = "flex items-center gap-3 bg-black/40 p-3 rounded-lg border border-slate-800";
                div.innerHTML = `
                    <div class="w-1 h-8 rounded" style="background:${m.color}"></div>
                    <div class="flex-1">
                        <div class="flex justify-between text-[10px] font-bold text-white uppercase">
                            <span>${m.name}</span>
                            <span class="text-blue-400">${m.chance.toFixed(1)}%</span>
                        </div>
                        <div class="w-full bg-slate-800 h-1 mt-1 rounded-full overflow-hidden">
                            <div class="h-full bg-blue-500" style="width: ${m.chance}%"></div>
                        </div>
                    </div>
                `;
                list.appendChild(div);
            });

            // Update Chart
            const labels = [];
            const data = [];
            for(let i = densityExp - 3; i <= densityExp + 3; i += 0.1) {
                labels.push(i.toFixed(1));
                data.push(getProb(i, densityExp, precision));
            }

            if (myChart) myChart.destroy();
            const ctx = document.getElementById('probChart').getContext('2d');
            myChart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        data: data,
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.2)',
                        fill: true,
                        pointRadius: 0,
                        borderWidth: 2,
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } },
                    scales: {
                        x: { ticks: { color: '#475569', size: 8 }, grid: { display: false } },
                        y: { display: false }
                    }
                }
            });
        }

        document.querySelectorAll('input').forEach(el => el.addEventListener('input', update));
    </script>
</body>
</html>
